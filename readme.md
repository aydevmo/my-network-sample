Please see my recent code sample at below, which processes Cisco ASA log and inserts location information.   
<https://github.com/aydevmo/my-network-sample/tree/main/python/log_processing_01>
